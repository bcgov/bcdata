<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Filter a query from Web Feature Service using dplyr
methods. This filtering is accomplished lazily so that
the full sf object is not read into memory until
collect() has been called.
See dplyr::filter for details."><title>Filter a query from bcdc_query_geodata() — filter.bcdc_promise • bcdata</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><link href="../deps/_Fira%20Mono-0.4.1/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Filter a query from bcdc_query_geodata() — filter.bcdc_promise"><meta property="og:description" content="Filter a query from Web Feature Service using dplyr
methods. This filtering is accomplished lazily so that
the full sf object is not read into memory until
collect() has been called.
See dplyr::filter for details."><meta property="og:image" content="https://bcgov.github.io/bcdata/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">bcdata</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.3.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/bcdata.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/efficiently-query-spatial-data-in-the-bc-data-catalogue.html">Querying Spatial Data with bcdata</a>
    <a class="dropdown-item" href="../articles/explore-silviculture-data-using-bcdata.html">Exploring Silviculture Data with bcdata</a>
    <a class="dropdown-item" href="../articles/service_documentation.html">bcdata Service Documentation</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bcgov/bcdata/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Filter a query from bcdc_query_geodata()</h1>
      <small class="dont-index">Source: <a href="https://github.com/bcgov/bcdata/blob/HEAD/R/utils-classes.R" class="external-link"><code>R/utils-classes.R</code></a>, <a href="https://github.com/bcgov/bcdata/blob/HEAD/R/utils-filter.R" class="external-link"><code>R/utils-filter.R</code></a></small>
      <div class="d-none name"><code>filter.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Filter a query from Web Feature Service using dplyr
methods. This filtering is accomplished lazily so that
the full sf object is not read into memory until
<code><a href="collect-methods.html">collect()</a></code> has been called.</p>
<p>See <code>dplyr::<a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></code> for details.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for bcdc_promise</span></span>
<span><span class="fu">filter</span><span class="op">(</span><span class="va">.data</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>.data</dt>
<dd><p>object of class <code>bcdc_promise</code> (likely passed from <code><a href="bcdc_query_geodata.html">bcdc_query_geodata()</a></code>)</p></dd>


<dt>...</dt>
<dd><p>Logical predicates with which to filter the results. Multiple
conditions are combined with <code>&amp;</code>. Only rows where the condition evaluates to
<code>TRUE</code> are kept. Accepts normal R expressions as well as any of the special
<a href="cql_geom_predicates.html">CQL geometry functions</a> such as <code><a href="cql_geom_predicates.html">WITHIN()</a></code> or <code><a href="cql_geom_predicates.html">INTERSECTS()</a></code>.
If you know <code>CQL</code> and want to write a <code>CQL</code> query directly, write it enclosed
in quotes, wrapped in the <code><a href="CQL.html">CQL()</a></code> function. e.g., <code>CQL("ID = '42'")</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="methods-by-class-">Methods (by class)<a class="anchor" aria-label="anchor" href="#methods-by-class-"></a></h2>
    
<ul><li><p><code>bcdc_promise</code>: filter.bcdc_promise</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">crd</span> <span class="op">&lt;-</span> <span class="fu"><a href="bcdc_query_geodata.html">bcdc_query_geodata</a></span><span class="op">(</span><span class="st">"regional-districts-legally-defined-administrative-areas-of-bc"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu">filter</span><span class="op">(</span><span class="va">ADMIN_AREA_NAME</span> <span class="op">==</span> <span class="st">"Cariboo Regional District"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="collect-methods.html">collect</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error : There was an issue sending this WFS request</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB0000;">▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Request:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   URL: https://openmaps.gov.bc.ca/geo/pub/wfs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   POST fields:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     resultType=hits&amp;SERVICE=WFS&amp;VERSION=2.0.0&amp;REQUEST=GetFeature&amp;outputFormat=application%2Fjson&amp;typeNames=WHSE_LEGAL_ADMIN_BOUNDARIES.ABMS_REGIONAL_DISTRICTS_SP&amp;SRSNAME=EPSG%3A3005&amp;CQL_FILTER=%28%22ADMIN_AREA_NAME%22%20%3D%20%27Cariboo%20Regional%20District%27%29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Content-Type: application/x-www-form-urlencoded</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Accept-Encoding: gzip, deflate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Accept: application/json, text/xml, application/xml, */*</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   User-Agent: https://github.com/bcgov/bcdata</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Response:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   status: HTTP/1.1 503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   date: Tue, 05 Jul 2022 18:39:52 GMT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   server: Apache</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   x-frame-options: allow-from (null)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   x-control-flow-delay-ms: 60004</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   content-type: text/html;charset=utf-8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   content-language: en</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   content-length: 1201</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   access-control-allow-origin: (null)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   access-control-allow-credentials: true</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   access-control-allow-methods: POST, GET, OPTIONS, HEAD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   access-control-allow-headers: X-Requested-With, Referer, Origin, Content-Type, SOAPAction, Authorization, Accept</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   access-control-max-age: 1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   connection: close</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">ret1</span> <span class="op">&lt;-</span> <span class="fu"><a href="bcdc_query_geodata.html">bcdc_query_geodata</a></span><span class="op">(</span><span class="st">"fire-perimeters-historical"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu">filter</span><span class="op">(</span><span class="va">FIRE_YEAR</span> <span class="op">==</span> <span class="fl">2000</span>, <span class="va">FIRE_CAUSE</span> <span class="op">==</span> <span class="st">"Person"</span>, <span class="fu"><a href="cql_geom_predicates.html">INTERSECTS</a></span><span class="op">(</span><span class="va">crd</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="collect-methods.html">collect</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error : object "crd" not found.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The object passed to INTERSECTS needs to be valid sf object.</span>
<span class="r-in"><span>  <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Andy Teucher, Sam Albers, Stephanie Hazlitt.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

    </footer></div>

  

  

  </body></html>

