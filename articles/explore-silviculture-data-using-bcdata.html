<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Exploring Silviculture Data with bcdata • bcdata</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Exploring Silviculture Data with bcdata">
<meta property="og:description" content="bcdata">
<meta property="og:image" content="https://bcgov.github.io/bcdata/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bcdata</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/bcdata.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/efficiently-query-spatial-data-in-the-bc-data-catalogue.html">Querying Spatial Data with bcdata</a>
    </li>
    <li>
      <a href="../articles/explore-silviculture-data-using-bcdata.html">Exploring Silviculture Data with bcdata</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bcgov/bcdata/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="explore-silviculture-data-using-bcdata_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Exploring Silviculture Data with bcdata</h1>
            
            <h4 class="date">2020-06-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/bcgov/bcdata/blob/master/vignettes/explore-silviculture-data-using-bcdata.Rmd"><code>vignettes/explore-silviculture-data-using-bcdata.Rmd</code></a></small>
      <div class="hidden name"><code>explore-silviculture-data-using-bcdata.Rmd</code></div>

    </div>

    
    
<!--
Copyright 2019 Province of British Columbia

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and limitations under the License.
-->
<p>This vignette will demonstrate how you can use <code>bcdata</code> to access and explore British Columbia silviculture data.</p>
<div id="silviculture-data" class="section level2">
<h2 class="hasAnchor">
<a href="#silviculture-data" class="anchor"></a>Silviculture Data</h2>
<p>Silviculture data for British Columbia are largely collected and stored through the <a href="https://www2.gov.bc.ca/gov/content?id=F62992DA5B324446AD5E1B5BFFA404CC">Reporting Silviculture Updates and Land Status Tracking System (RESULTS) database</a>—including information on the management of openings, disturbances, silviculture activities and obligation declarations as required by the <a href="https://www2.gov.bc.ca/gov/content?id=D65006C0326B4E0F838194044C10CA86">Forest and Range Practices Act</a>. <a href="https://catalogue.data.gov.bc.ca/dataset?q=RESULTS+silviculture">RESULTS data sets are publically available through the B.C. Data Catalogue</a> under the <a href="https://www2.gov.bc.ca/gov/content?id=A519A56BC2BF44E4A008B33FCF527F61">Open Government Licence - British Columbia</a>.</p>
</div>
<div id="reforestation-with-climate-considerations" class="section level2">
<h2 class="hasAnchor">
<a href="#reforestation-with-climate-considerations" class="anchor"></a>Reforestation with Climate Considerations</h2>
<p><a href="https://en.wikipedia.org/wiki/Larix_occidentalis">Western larch</a> has been identified as a tree species that will be well-adapted to projected future climates in northern British Columbia. In 2013, forest policy was developed that allowed foresters to plant western larch outside of its natural range as a climate change adaptation silviculture measure.</p>
<div id="how-much-western-larch-has-been-planted-in-the-prince-george-natural-resource-district" class="section level4">
<h4 class="hasAnchor">
<a href="#how-much-western-larch-has-been-planted-in-the-prince-george-natural-resource-district" class="anchor"></a>How much western larch has been planted in the Prince George Natural Resource District?</h4>
<p>Let’s use the <code>bcdata</code> package to search, retrieve and explore the RESULTS silviculture data and answer this question.</p>
</div>
</div>
<div id="getting-started" class="section level2">
<h2 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting Started</h2>
<p>To start, let’s load the <code>bcdata</code> package. We will also load the <code>dplyr</code> and <code>ggplot2</code> packages to help us work with the data. You can learn more about the <code>dplyr</code> package <a href="https://dplyr.tidyverse.org/">here</a> and the <code>ggplot2</code> package <a href="https://ggplot2.tidyverse.org/">here</a>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://bcgov.github.io/bcdata/">bcdata</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="getting-the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#getting-the-data" class="anchor"></a>Getting the Data</h2>
<p>We can gather the data we need to answer our question using the <a href="https://catalogue.data.gov.bc.ca/dataset/258bb088-4113-47b1-b568-ce20bd64e3e3">RESULTS - silviculture forest cover dataset</a>. First, let’s take a look at the metadata record using <code><a href="../reference/bcdc_get_record.html">bcdc_get_record()</a></code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Get the metadata using the human-readable record name</span>
<span class="fu"><a href="../reference/bcdc_get_record.html">bcdc_get_record</a></span><span class="op">(</span><span class="st">"results-forest-cover-silviculture"</span><span class="op">)</span>
<span class="co">#&gt; B.C. Data Catalogue Record: RESULTS - Forest Cover Silviculture </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Name: results-forest-cover-silviculture (ID: 258bb088-4113-47b1-b568-ce20bd64e3e3 )</span>
<span class="co">#&gt; Permalink: https://catalogue.data.gov.bc.ca/dataset/258bb088-4113-47b1-b568-ce20bd64e3e3</span>
<span class="co">#&gt; Sector: Natural Resources</span>
<span class="co">#&gt; Licence: Open Government Licence - British Columbia</span>
<span class="co">#&gt; Type: Geographic</span>
<span class="co">#&gt; Last Updated: 2020-05-25 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Description: RESULTS opening's forest cover poylgons with silviculture component provided.</span>
<span class="co">#&gt; Current forest cover subimssion into RESULTS must contain attribute and map</span>
<span class="co">#&gt; information.  However, there are historical forest cover polygon infomration where</span>
<span class="co">#&gt; maps are not available.  Forest Cover is provided at three critical milestones of at</span>
<span class="co">#&gt; harvesting, at regeneration, and at free growing.  This is a part o fthe</span>
<span class="co">#&gt; Silviculture and Land Status Tracking dataset, which includes tracking achievement</span>
<span class="co">#&gt; of silviculture obligations on Crown Land </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Resources: (3)</span>
<span class="co">#&gt; # A tibble: 3 x 8</span>
<span class="co">#&gt;   name     url        id      format ext   package_id  location bcdata_available</span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;    &lt;lgl&gt;           </span>
<span class="co">#&gt; 1 BC Geog… https://c… 92f845… other  ""    258bb088-4… bcgeogr… FALSE           </span>
<span class="co">#&gt; 2 WMS get… https://o… 57670a… wms    ""    258bb088-4… bcgeogr… TRUE            </span>
<span class="co">#&gt; 3 KML Net… https://o… d45a82… kml    "kml" 258bb088-4… bcgeogr… FALSE           </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; You can access the 'Resources' data frame using bcdc_tidy_resources()</span></code></pre></div>
<p>We see that this is a <a href="https://www2.gov.bc.ca/gov/content?id=95D78D544B244F34B89223EF069DF74E">Web Service-enabled</a> geospatial data set—the list of data resources includes <code>WMS getCapabilities request</code>—so we can query and retrieve this geospatial data set using <code><a href="../reference/bcdc_query_geodata.html">bcdc_query_geodata()</a></code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Query the data using the permanent ID of the record to guard against name changes</span>
<span class="fu"><a href="../reference/bcdc_query_geodata.html">bcdc_query_geodata</a></span><span class="op">(</span><span class="st">"258bb088-4113-47b1-b568-ce20bd64e3e3"</span><span class="op">)</span>
<span class="co">#&gt; Querying 'results-forest-cover-silviculture' record</span>
<span class="co">#&gt; ● Using collect() on this object will return 873108 features and 159 fields</span>
<span class="co">#&gt; ● At most six rows of the record are printed here</span>
<span class="co">#&gt; ────────────────────────────────────────────────────────────────────────────────</span>
<span class="co">#&gt; Simple feature collection with 6 features and 159 fields</span>
<span class="co">#&gt; geometry type:  MULTIPOLYGON</span>
<span class="co">#&gt; dimension:      XY</span>
<span class="co">#&gt; bbox:           xmin: 1147890 ymin: 676633.7 xmax: 1411085 ymax: 1083545</span>
<span class="co">#&gt; CRS:            3005</span>
<span class="co">#&gt; # A tibble: 6 x 160</span>
<span class="co">#&gt;   id    FOREST_COVER_ID STOCKING_STANDA… OPENING_ID STANDARDS_UNIT_…</span>
<span class="co">#&gt;   &lt;chr&gt;           &lt;int&gt;            &lt;int&gt;      &lt;int&gt; &lt;chr&gt;           </span>
<span class="co">#&gt; 1 WHSE…         3994018          1805957    1486231 2               </span>
<span class="co">#&gt; 2 WHSE…         3994007               NA    1248495 &lt;NA&gt;            </span>
<span class="co">#&gt; 3 WHSE…         3993995          2263260    1728926 1               </span>
<span class="co">#&gt; 4 WHSE…         3994067               NA    1120935 &lt;NA&gt;            </span>
<span class="co">#&gt; 5 WHSE…         3994009          1404558    1248495 A               </span>
<span class="co">#&gt; 6 WHSE…         3994057          1211894    1120935 B               </span>
<span class="co">#&gt; # … with 155 more variables: SILV_POLYGON_NUMBER &lt;chr&gt;,</span>
<span class="co">#&gt; #   SILV_POLYGON_AREA &lt;dbl&gt;, SILV_POLYGON_NET_AREA &lt;dbl&gt;,</span>
<span class="co">#&gt; #   SILV_NON_MAPPED_AREA &lt;int&gt;, STOCKING_STATUS_CODE &lt;chr&gt;,</span>
<span class="co">#&gt; #   STOCKING_TYPE_CODE &lt;chr&gt;, STOCKING_CLASS_CODE &lt;chr&gt;,</span>
<span class="co">#&gt; #   SILV_RESERVE_CODE &lt;chr&gt;, SILV_RESERVE_OBJECTIVE_CODE &lt;chr&gt;,</span>
<span class="co">#&gt; #   TREE_COVER_PATTERN_CODE &lt;chr&gt;, REENTRY_YEAR &lt;chr&gt;, REFERENCE_YEAR &lt;int&gt;,</span>
<span class="co">#&gt; #   SITE_INDEX &lt;int&gt;, SITE_INDEX_SOURCE_CODE &lt;chr&gt;, BGC_ZONE_CODE &lt;chr&gt;,</span>
<span class="co">#&gt; #   BGC_SUBZONE_CODE &lt;chr&gt;, BGC_VARIANT &lt;chr&gt;, BGC_PHASE &lt;chr&gt;,</span>
<span class="co">#&gt; #   BEC_SITE_SERIES &lt;chr&gt;, BEC_SITE_TYPE &lt;chr&gt;, BEC_SERAL &lt;chr&gt;,</span>
<span class="co">#&gt; #   IS_SILV_IMPLIED_IND &lt;chr&gt;, FOREST_COVER_SILV_TYPE &lt;chr&gt;,</span>
<span class="co">#&gt; #   S_FOREST_COVER_LAYER_ID &lt;int&gt;, S_TOTAL_STEMS_PER_HA &lt;chr&gt;,</span>
<span class="co">#&gt; #   S_TOTAL_WELL_SPACED_STEMS_HA &lt;int&gt;, S_WELL_SPACED_STEMS_PER_HA &lt;int&gt;,</span>
<span class="co">#&gt; #   S_FREE_GROWING_STEMS_PER_HA &lt;int&gt;, S_CROWN_CLOSURE_PERCENT &lt;chr&gt;,</span>
<span class="co">#&gt; #   S_BASAL_AREA &lt;chr&gt;, S_SPECIES_CODE_1 &lt;chr&gt;, S_SPECIES_PERCENT_1 &lt;int&gt;,</span>
<span class="co">#&gt; #   S_SPECIES_AGE_1 &lt;int&gt;, S_SPECIES_HEIGHT_1 &lt;dbl&gt;, S_SPECIES_CODE_2 &lt;chr&gt;,</span>
<span class="co">#&gt; #   S_SPECIES_PERCENT_2 &lt;int&gt;, S_SPECIES_AGE_2 &lt;chr&gt;, S_SPECIES_HEIGHT_2 &lt;chr&gt;,</span>
<span class="co">#&gt; #   S_SPECIES_CODE_3 &lt;chr&gt;, S_SPECIES_PERCENT_3 &lt;int&gt;, S_SPECIES_CODE_4 &lt;chr&gt;,</span>
<span class="co">#&gt; #   S_SPECIES_PERCENT_4 &lt;chr&gt;, S_SPECIES_CODE_5 &lt;chr&gt;,</span>
<span class="co">#&gt; #   S_SPECIES_PERCENT_5 &lt;chr&gt;, S_MORE_SPECIES_EXIST_IND &lt;chr&gt;,</span>
<span class="co">#&gt; #   S_SILV_LABEL &lt;chr&gt;, S1_FOREST_COVER_LAYER_ID &lt;int&gt;,</span>
<span class="co">#&gt; #   S1_TOTAL_STEMS_PER_HA &lt;int&gt;, S1_TOTAL_WELL_SPACED_STEMS_HA &lt;int&gt;,</span>
<span class="co">#&gt; #   S1_WELL_SPACED_STEMS_PER_HA &lt;int&gt;, S1_FREE_GROWING_STEMS_PER_HA &lt;int&gt;,</span>
<span class="co">#&gt; #   S1_CROWN_CLOSURE_PERCENT &lt;int&gt;, S1_BASAL_AREA &lt;chr&gt;,</span>
<span class="co">#&gt; #   S1_SPECIES_CODE_1 &lt;chr&gt;, S1_SPECIES_PERCENT_1 &lt;int&gt;,</span>
<span class="co">#&gt; #   S1_SPECIES_AGE_1 &lt;int&gt;, S1_SPECIES_HEIGHT_1 &lt;int&gt;, S1_SPECIES_CODE_2 &lt;chr&gt;,</span>
<span class="co">#&gt; #   S1_SPECIES_PERCENT_2 &lt;chr&gt;, S1_SPECIES_AGE_2 &lt;chr&gt;,</span>
<span class="co">#&gt; #   S1_SPECIES_HEIGHT_2 &lt;chr&gt;, S1_SPECIES_CODE_3 &lt;chr&gt;,</span>
<span class="co">#&gt; #   S1_SPECIES_PERCENT_3 &lt;chr&gt;, S1_SPECIES_CODE_4 &lt;chr&gt;,</span>
<span class="co">#&gt; #   S1_SPECIES_PERCENT_4 &lt;chr&gt;, S1_SPECIES_CODE_5 &lt;chr&gt;,</span>
<span class="co">#&gt; #   S1_SPECIES_PERCENT_5 &lt;chr&gt;, S1_MORE_SPECIES_EXIST_IND &lt;chr&gt;,</span>
<span class="co">#&gt; #   S1_SILV_LABEL &lt;chr&gt;, S2_FOREST_COVER_LAYER_ID &lt;int&gt;,</span>
<span class="co">#&gt; #   S2_TOTAL_STEMS_PER_HA &lt;int&gt;, S2_TOTAL_WELL_SPACED_STEMS_HA &lt;int&gt;,</span>
<span class="co">#&gt; #   S2_WELL_SPACED_STEMS_PER_HA &lt;int&gt;, S2_FREE_GROWING_STEMS_PER_HA &lt;int&gt;,</span>
<span class="co">#&gt; #   S2_CROWN_CLOSURE_PERCENT &lt;int&gt;, S2_BASAL_AREA &lt;chr&gt;,</span>
<span class="co">#&gt; #   S2_SPECIES_CODE_1 &lt;chr&gt;, S2_SPECIES_PERCENT_1 &lt;int&gt;,</span>
<span class="co">#&gt; #   S2_SPECIES_AGE_1 &lt;int&gt;, S2_SPECIES_HEIGHT_1 &lt;int&gt;, S2_SPECIES_CODE_2 &lt;chr&gt;,</span>
<span class="co">#&gt; #   S2_SPECIES_PERCENT_2 &lt;chr&gt;, S2_SPECIES_AGE_2 &lt;chr&gt;,</span>
<span class="co">#&gt; #   S2_SPECIES_HEIGHT_2 &lt;chr&gt;, S2_SPECIES_CODE_3 &lt;chr&gt;,</span>
<span class="co">#&gt; #   S2_SPECIES_PERCENT_3 &lt;chr&gt;, S2_SPECIES_CODE_4 &lt;chr&gt;,</span>
<span class="co">#&gt; #   S2_SPECIES_PERCENT_4 &lt;chr&gt;, S2_SPECIES_CODE_5 &lt;chr&gt;,</span>
<span class="co">#&gt; #   S2_SPECIES_PERCENT_5 &lt;chr&gt;, S2_MORE_SPECIES_EXIST_IND &lt;chr&gt;,</span>
<span class="co">#&gt; #   S2_SILV_LABEL &lt;chr&gt;, S3_FOREST_COVER_LAYER_ID &lt;int&gt;,</span>
<span class="co">#&gt; #   S3_TOTAL_STEMS_PER_HA &lt;int&gt;, S3_TOTAL_WELL_SPACED_STEMS_HA &lt;int&gt;,</span>
<span class="co">#&gt; #   S3_WELL_SPACED_STEMS_PER_HA &lt;int&gt;, S3_FREE_GROWING_STEMS_PER_HA &lt;int&gt;,</span>
<span class="co">#&gt; #   S3_CROWN_CLOSURE_PERCENT &lt;int&gt;, S3_BASAL_AREA &lt;chr&gt;,</span>
<span class="co">#&gt; #   S3_SPECIES_CODE_1 &lt;chr&gt;, …</span></code></pre></div>
<p>This query shows that this data set has over 850,000 features and over 150 fields. Each feature is a treatment unit within a harvested opening, and contains information on the leading five tree species that are present in each treatment unit, including stems per hectare, age, and height.</p>
<p>Note that we have only <em>queried</em> the data set so far—the data set would be too large (~1GB) to download efficiently. So, let’s use <code><a href="../reference/filter.bcdc_promise.html">filter()</a></code> with <code><a href="../reference/bcdc_query_geodata.html">bcdc_query_geodata()</a></code> to refine our query <em>before</em> we collect the data and import it into R.</p>
</div>
<div id="refining-a-geospatial-data-query" class="section level2">
<h2 class="hasAnchor">
<a href="#refining-a-geospatial-data-query" class="anchor"></a>Refining a Geospatial Data Query</h2>
<p>To address our question, we need the treatment data (1) from the Prince George Natural Resource District <em>and</em> (2) that contain western larch.</p>
<p>First, we can use the <code>bcdata</code> package to download the spatial boundary for the Prince George Natural Resource District—<code>DPG</code> is the <code>ORG_UNIT</code> for Prince George Natural Resource District:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Create a spatial feature object named dpg</span>
<span class="va">dpg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bcdc_query_geodata.html">bcdc_query_geodata</a></span><span class="op">(</span><span class="st">"natural-resource-nr-district"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/filter.bcdc_promise.html">filter</a></span><span class="op">(</span><span class="va">ORG_UNIT</span><span class="op">==</span><span class="st">"DPG"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># filter for Prince George Natural Resource District</span>
  <span class="fu"><a href="../reference/as_tibble.html">collect</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># and collect the data</span></code></pre></div>
<p>Let’s plot this spatial object and double check we have we what we need:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dpg</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="vignette-fig-plot-dpg-1.png" title="plot of chunk plot-dpg" alt="plot of chunk plot-dpg" width="100%"></p>
<p>Now we have a spatial object that we can use as a bounding box to filter and download records in the RESULTS - silviculture layer from the Prince George Natural Resource District.</p>
<p>We only need to download the treatments that have western larch planted. We can use the <code><a href="../reference/bcdc_describe_feature.html">bcdc_describe_feature()</a></code> helper function to examine the column names and types of the layer. In this case, we want to keep rows where the five <code>S_SPECIES_CODE_*</code> columns contain <code>"LW"</code>, the code for western larch.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Make a vector of tree species we are interested in</span>
<span class="co"># (in this case only LW for western larch)</span>
<span class="va">spp_list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LW"</span><span class="op">)</span>

<span class="co"># Query and filter the data layer</span>
<span class="va">trees_dpg</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/bcdc_query_geodata.html">bcdc_query_geodata</a></span><span class="op">(</span><span class="st">"258bb088-4113-47b1-b568-ce20bd64e3e3"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/filter.bcdc_promise.html">filter</a></span><span class="op">(</span><span class="fu"><a href="../reference/cql_geom_predicates.html">INTERSECTS</a></span><span class="op">(</span><span class="va">dpg</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co">#filter for records that are within the DPG boundary</span>
  <span class="fu"><a href="../reference/filter.bcdc_promise.html">filter</a></span><span class="op">(</span>
      <span class="va">S_SPECIES_CODE_1</span> <span class="op">%in%</span> <span class="va">spp_list</span> <span class="op">|</span>  <span class="co">#filter for LW records</span>
      <span class="va">S_SPECIES_CODE_2</span> <span class="op">%in%</span> <span class="va">spp_list</span> <span class="op">|</span>
      <span class="va">S_SPECIES_CODE_3</span> <span class="op">%in%</span> <span class="va">spp_list</span> <span class="op">|</span>
      <span class="va">S_SPECIES_CODE_4</span> <span class="op">%in%</span> <span class="va">spp_list</span> <span class="op">|</span>
      <span class="va">S_SPECIES_CODE_5</span> <span class="op">%in%</span> <span class="va">spp_list</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/as_tibble.html">collect</a></span><span class="op">(</span><span class="op">)</span> <span class="co">#collect/download the data</span></code></pre></div>
</div>
<div id="exploring-the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#exploring-the-data" class="anchor"></a>Exploring the Data</h2>
<p>Let’s look at the dimensions of this now much more manageable data object we have downloaded from the B.C. Data Catalogue:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">trees_dpg</span><span class="op">)</span>
<span class="co">#&gt; [1] 160 160</span></code></pre></div>
<p>We can see there are 160 treatment units planted with western larch, and we can make a quick map of these harvested openings for the Prince George Natural Resource District:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">trees_dpg</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dpg</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span> <span class="co">#add the DPG spatial boundary</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="vignette-fig-map-larch-plantations-dpg-1.png" title="plot of chunk map-larch-plantations-dpg" alt="plot of chunk map-larch-plantations-dpg" width="100%"></p>
<p>We can also create some quick descriptive summaries of the data, treating the geospatial attribute table as a data frame in R, and answer our original question—how much western larch has been planted in the Prince George Natural Resource District?</p>
<div id="what-is-the-size-and-age-distribution-of-larch-plantations-in-the-prince-george-natural-resource-district-in-the-year-2020" class="section level4">
<h4 class="hasAnchor">
<a href="#what-is-the-size-and-age-distribution-of-larch-plantations-in-the-prince-george-natural-resource-district-in-the-year-2020" class="anchor"></a>What is the size and age distribution of larch plantations in the Prince George Natural Resource District in the year 2020?</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">trees_dpg</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/mutate.bcdc_promise.html">mutate</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fl">2020</span> <span class="op">-</span> <span class="va">REFERENCE_YEAR</span> <span class="op">+</span> <span class="va">S_SPECIES_AGE_1</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co">#create a plantation age column</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  <span class="co">#start a plot</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">FEATURE_AREA_SQM</span><span class="op">/</span><span class="fl">10000</span><span class="op">)</span> <span class="op">+</span> <span class="co">#convert feature area to hectares</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"sum"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Stand Age (years)"</span>,
                     limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">30</span><span class="op">)</span>,
                     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">5</span>, to <span class="op">=</span> <span class="fl">30</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Sum Treatment Unit Area (ha)"</span>,
       title <span class="op">=</span> <span class="st">"Area Planted with Western Larch by Stand Age\nin Prince George Natural Resource District"</span>,
       caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Data sourced from the B.C. Data Catalogue\n on "</span>,
                        <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span><span class="op">(</span><span class="op">)</span>,
                        <span class="st">" using the bcdata R package"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></code></pre></div>
<p><img src="vignette-fig-unnamed-chunk-1-1.png" title="plot of chunk unnamed-chunk-1" alt="plot of chunk unnamed-chunk-1" width="100%"></p>
</div>
<div id="what-is-the-biogeoclimatic-ecosystem-classification-bec-distribution-of-western-larch-plantations-in-the-prince-george-natural-resource-district" class="section level4">
<h4 class="hasAnchor">
<a href="#what-is-the-biogeoclimatic-ecosystem-classification-bec-distribution-of-western-larch-plantations-in-the-prince-george-natural-resource-district" class="anchor"></a>What is the Biogeoclimatic Ecosystem Classification (BEC) distribution of western larch plantations in the Prince George Natural Resource District?</h4>
<p>We can download <a href="https://catalogue.data.gov.bc.ca/dataset/bec-map">British Columbia biogeoclimatic (BEC) data</a> from the B.C. Data Catalogue using <code>bcdata</code> and join to our existing <code>trees_dpg</code> geospatial dataset using the <code>st_join</code> function from the <code>sf</code> package. You can learn more about <code>sf</code> <a href="https://r-spatial.github.io/sf/">here</a>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span> <span class="co">#load the sf package</span>

<span class="co"># Load the BEC data for Prince George Natural Resource District</span>
<span class="va">bgc_dpg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bcdc_query_geodata.html">bcdc_query_geodata</a></span><span class="op">(</span><span class="st">"WHSE_FOREST_VEGETATION.BEC_BIOGEOCLIMATIC_POLY"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/filter.bcdc_promise.html">filter</a></span><span class="op">(</span><span class="fu"><a href="../reference/cql_geom_predicates.html">BBOX</a></span><span class="op">(</span><span class="va">dpg</span>, crs <span class="op">=</span> <span class="va">`EPSG:3005`</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co">#note filtering with a BoundingBox</span>
  <span class="fu"><a href="../reference/as_tibble.html">collect</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># Join the BEC data with our tress_dpg geospatial data set</span>
<span class="va">trees_bec_dpg</span> <span class="op">&lt;-</span> <span class="va">trees_dpg</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_join.html">st_join</a></span><span class="op">(</span><span class="va">bgc_dpg</span><span class="op">[</span>, <span class="st">"MAP_LABEL"</span><span class="op">]</span><span class="op">)</span> <span class="co">#join BEC data for each polygon</span></code></pre></div>
<p>Now, we can summarize the area planted with western larch by biogeoclimatic unit:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">trees_bec_dpg</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">MAP_LABEL</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># group polygons by biogeoclimatic unit</span>
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/tidyverse.html">summarise</a></span><span class="op">(</span>Area <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">FEATURE_AREA_SQM</span><span class="op">)</span><span class="op">/</span><span class="fl">10000</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">MAP_LABEL</span>, y <span class="op">=</span> <span class="va">Area</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Sum Treatment Unit Area (ha)"</span>,
       x <span class="op">=</span> <span class="st">"Biogeoclimatic Unit"</span>,
       title <span class="op">=</span> <span class="st">"Area Planted with Western Larch by Biogeoclimatic Unit\nin Prince George Natural Resource District"</span>,
       caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Data sourced from the B.C. Data Catalogue\n on "</span>,
                        <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span><span class="op">(</span><span class="op">)</span>,
                        <span class="st">" using the bcdata R package"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></code></pre></div>
<p><img src="vignette-fig-unnamed-chunk-3-1.png" title="plot of chunk unnamed-chunk-3" alt="plot of chunk unnamed-chunk-3" width="100%"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Andy Teucher, Sam Albers, Stephanie Hazlitt.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
